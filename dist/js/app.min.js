/*! HTML5_2D_Shooter 06-02-2014 */

function Drawable(){this.init=function(a,b,c,d){this.x=a,this.y=b,this.width=c,this.height=d},this.speed=0,this.canvasWidth=0,this.canvasHeight=0,this.draw=function(){},this.move=function(){}}function MainCharacter(){this.speed={x:3,y:5},this.bulletPool=new BulletPool(30);var a=15,b=0,c=!1,d=15,e=0;this.init=function(a,b,c,d){this.x=a,this.y=b,this.width=c,this.height=d,this.alive=!0,this.bulletPool.init("bullet"),this.facingLeft=!1},this.draw=function(){this.context.drawImage(imgRepo.main,this.x,this.y)},this.move=function(){b++,(KEY_STATUS.left||KEY_STATUS.right||KEY_STATUS.up||c)&&(this.context.clearRect(this.x,this.y,this.width,this.height),KEY_STATUS.left?(this.facingLeft=!0,this.x-=this.speed.x,this.x<=0&&(this.x=0)):KEY_STATUS.right&&(this.facingLeft=!1,this.x+=this.speed.x,this.x>=this.canvasWidth-this.width&&(this.x=this.canvasWidth-this.width)),KEY_STATUS.up&&!c&&(c=!0)),c&&this.jump(),this.draw(),KEY_STATUS.space&&b>=a&&(this.fire(),b=0)},this.fire=function(){var a=this.facingLeft?-5:5,b=this.facingLeft?this.x-imgRepo.mainBullet.width:this.x+this.width;this.bulletPool.shoot(b,this.y+6,a)},this.jump=function(){e++,e===d&&(this.speed.y=-this.speed.y),e===2*d&&(this.speed.y=-this.speed.y,c=!1,e=0),this.y-=this.speed.y,this.y>this.canvasHeight-10&&(this.y=this.canvasHeight-10)}}function Enemy(){this.init=function(a,b,c,d){this.x=a,this.y=b,this.width=c,this.height=d,this.alive=!0,this.facingLeft=!1},this.draw=function(){return this.context.clearRect(this.x-1,this.y,this.width+1,this.height),this.x+=this.speed.x,this.y+=this.speed.y,this.calculateBehaviour(),this.context.drawImage(this.image(),this.x,this.y),!1},this.bulletHeight=function(){return this.y},this.fire=function(){var a=this.facingLeft?-4:4,b=this.facingLeft?this.x-imgRepo.enemyBullet.width:this.x+this.width;game.enemyBulletPool.shoot(b,this.bulletHeight(),a)},this.calculateBehaviour=function(){},this.image=function(){}}function Enemy_A(){this.limit=null,this.speed={x:1,y:0},this.bulletHeight=function(){return this.y+this.height/2},this.image=function(){return imgRepo.enemy_1},this.calculateBehaviour=function(){this.limit||(this.limit={left:this.x-45,right:this.x+45}),this.x<=this.limit.left?(this.fire(),this.facingLeft=!1,this.speed.x=-this.speed.x):this.x>=this.limit.right+this.width&&(this.fire(),this.facingLeft=!0,this.speed.x=-this.speed.x)}}function Enemy_B(){this.speed={x:0,y:1},this.limit=null,this.image=function(){return imgRepo.enemy_2},this.calculateBehaviour=function(){this.limit||(this.limit={up:this.y-this.height,down:this.y+this.height}),this.y<=this.limit.up?(this.facingLeft=!this.facingLeft,this.speed.y=-this.speed.y,this.fire()):this.y>=this.limit.down&&(this.speed.y=-this.speed.y)}}function Bullet(a){this.alive=!1;var b=a;this.spawn=function(a,b,c){this.x=a,this.y=b,this.speed=c,this.alive=!0},this.draw=function(){return this.context.clearRect(this.x-1,this.y-1,this.width+2,this.height+2),this.x+=this.speed,this.x<0||this.x>this.canvasWidth-this.width?!0:("bullet"===b?this.context.drawImage(imgRepo.mainBullet,this.x,this.y):"enemyBullet"===b&&this.context.drawImage(imgRepo.enemyBullet,this.x,this.y),!1)},this.clear=function(){this.x=0,this.y=0,this.speed=0,this.alive=!1}}function init(){game.init()&&game.start()}function Game(){this.init=function(){return this.bgCanvas=document.getElementById("bg"),this.enemiesCanvas=document.getElementById("enemies"),this.mainCanvas=document.getElementById("main"),this.obstaclesCanvas=document.getElementById("obstacles"),this.bgCanvas.getContext?(this.bgContext=this.bgCanvas.getContext("2d"),this.enemiesContext=this.enemiesCanvas.getContext("2d"),this.mainContext=this.mainCanvas.getContext("2d"),this.obstaclesContext=this.obstaclesCanvas.getContext("2d"),MainCharacter.prototype.context=this.mainContext,MainCharacter.prototype.canvasWidth=this.mainCanvas.width,MainCharacter.prototype.canvasHeight=this.mainCanvas.height,Enemy_A.prototype.context=this.enemiesContext,Enemy_A.prototype.canvasWidth=this.enemiesCanvas.width,Enemy_A.prototype.canvasHeight=this.enemiesCanvas.height,Enemy_B.prototype.context=this.enemiesContext,Enemy_B.prototype.canvasWidth=this.enemiesCanvas.width,Enemy_B.prototype.canvasHeight=this.enemiesCanvas.height,Bullet.prototype.context=this.enemiesContext,Bullet.prototype.canvasWidth=this.enemiesCanvas.width,Bullet.prototype.canvasHeight=this.enemiesCanvas.height,this.mainCharacter=new MainCharacter,this.mainCharacter.init(10,this.mainCanvas.height-imgRepo.main.height,imgRepo.main.width,imgRepo.main.height),this.firstEnemy=new Enemy_A,this.firstEnemy.init(200,this.enemiesCanvas.height-imgRepo.enemy_1.height,imgRepo.enemy_1.width,imgRepo.enemy_1.height),this.secondEnemy=new Enemy_A,this.secondEnemy.init(400,this.enemiesCanvas.height-imgRepo.enemy_1.height,imgRepo.enemy_1.width,imgRepo.enemy_1.height),this.thirdEnemy=new Enemy_B,this.thirdEnemy.init(600,this.enemiesCanvas.height,imgRepo.enemy_2.width,imgRepo.enemy_2.height),this.enemyBulletPool=new BulletPool(40),this.enemyBulletPool.init("enemyBullet"),!0):!1},this.start=function(){console.log("START"),this.mainCharacter.draw(),animate()}}function animate(){requestAnimFrame(animate),game.mainCharacter.move(),game.mainCharacter.bulletPool.animate(),game.firstEnemy.draw(),game.secondEnemy.draw(),game.thirdEnemy.draw(),game.enemyBulletPool.animate()}function ImgRepo(){function a(){return d++,new Image}function b(){c++,c===d&&(console.log("all images loaded"),window.init())}var c=0,d=0;this.mainBullet=a(),this.enemyBullet=a(),this.main=a(),this.enemy_1=a(),this.enemy_2=a(),this.mainBullet.onload=function(){b()},this.enemyBullet.onload=function(){b()},this.main.onload=function(){b()},this.enemy_1.onload=function(){b()},this.enemy_2.onload=function(){b()},this.mainBullet.src="./img/bullet_main.png",this.enemyBullet.src="./img/bullet_enemy.png",this.main.src="./img/main.png",this.enemy_1.src="./img/enemy_1.png",this.enemy_2.src="./img/enemy_2.png"}function BulletPool(a){var b=a,c=[];this.getPool=function(){for(var a=[],d=0;b>d;d++)c[d].alive&&a.push(c[d]);return a},this.init=function(a){if("bullet"===a||"enemyBullet"===a){var d,e;if("bullet"===a)for(e=0;b>e;e++)d=new Bullet("bullet"),d.init(0,0,imgRepo.mainBullet.width,imgRepo.mainBullet.height),c[e]=d;else if("enemyBullet"===a)for(e=0;b>e;e++)d=new Bullet("enemyBullet"),d.init(0,0,imgRepo.enemyBullet.width,imgRepo.enemyBullet.height),c[e]=d}},this.shoot=function(a,d,e){c[b-1].alive||(c[b-1].spawn(a,d,e),c.unshift(c.pop()))},this.animate=function(){for(var a=0;b>a&&c[a].alive;a++)c[a].draw()&&(c[a].clear(),c.push(c.splice(a,1)[0]))}}MainCharacter.prototype=new Drawable,Enemy.prototype=new Drawable,Enemy_A.prototype=new Enemy,Enemy_B.prototype=new Enemy,Bullet.prototype=new Drawable;var game=new Game,imgRepo=new ImgRepo;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),KEY_CODES={32:"space",37:"left",38:"up",39:"right"},KEY_STATUS={};for(var code in KEY_CODES)KEY_STATUS[KEY_CODES[code]]=!1;document.onkeydown=function(a){var b=a.keyCode?a.keyCode:a.charCode;KEY_CODES[b]&&(a.preventDefault(),KEY_STATUS[KEY_CODES[b]]=!0)},document.onkeyup=function(a){var b=a.keyCode?a.keyCode:a.charCode;KEY_CODES[b]&&(a.preventDefault(),KEY_STATUS[KEY_CODES[b]]=!1)};
//# sourceMappingURL=app.min.map